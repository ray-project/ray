depsets:
  ray_vllm_depset:
    requirements:
      - python/requirements_copy.txt
    constraints:
      - python/requirements_compiled.txt
    output: python/requirements_vllm.txt
    operation: compile
    flags:
      - --strip-extras
      - --no-header
      - --no-cache
      - --python-version=3.11
      - --no-strip-markers
      - --emit-index-url
      - --emit-find-links
      - --prerelease=allow
  
  subset_vllm_depset:
    operation: subset
    depset: ray_vllm_depset
    packages:
      - rpds-py
      - referencing
      - requests # can be defined in a file
    output: python/requirements_subset_vllm.txt

  expand_vllm_depset_py39:
    operation: expand
    depsets: 
     - ray_vllm_depset
    constraints:
      - python/requirements_compiled.txt
    output: python/requirements_expand_vllm_py39.txt
    flags:
      - --strip-extras
      - --generate-hashes
      - --no-header
      - --no-cache
      - --python-version=3.9
      - --no-strip-markers
      - --emit-index-url
      - --emit-find-links
      - --prerelease=allow

  ray_vllm_relaxed_depset: # becomes a requirements file (no verisons)
    operation: relax
    depset: expand_vllm_depset_py39
    degree: 0 # only support degree 1 or 0
    output: python/requirements_ray_vllm_relaxed.txt