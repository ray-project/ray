# Ray-ML Anyscale CUDA Image (for release tests)
# Installs ray wheel into the ray-ml CUDA base-extra-testdeps image
#
# This produces the anyscale test image for ray-ml GPU release tests.
# Uses ray-ml base with extra test dependencies.
#
name: "ray-ml-anyscale-py$PYTHON_VERSION-cu$CUDA_VERSION$ARCH_SUFFIX"
disable_caching: true
froms:
  - "@ray-ml-py$PYTHON_VERSION-cu$CUDA_VERSION-base-extra-testdeps"  # ray-ml base with test deps
  - "@ray-wheel-py$PYTHON_VERSION$ARCH_SUFFIX"                       # Ray wheel
dockerfile: ci/docker/ray-image.Dockerfile
srcs:
  - python/requirements_compiled.txt
build_args:
  - PYTHON_VERSION
  - CUDA_VERSION
  - ARCH_SUFFIX
  - BASE_IMAGE=ray-ml-py$PYTHON_VERSION-cu$CUDA_VERSION-base-extra-testdeps
  - RAY_WHEEL_IMAGE=ray-wheel-py$PYTHON_VERSION$ARCH_SUFFIX
