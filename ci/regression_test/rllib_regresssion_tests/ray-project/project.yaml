# This file is generated by `ray project create`.

name: rllib_regression_tests

# description: A short description of the project.
# The URL of the repo this project is part of.
# repo: ...

cluster:
  config: ray-project/cluster.yaml
  params:
    - name: ray_version # Ray version string.
      default: "0.8.2"

    - name: commit # Ray commit SHA string.
      default: "f5a1307a608fe5fdbdb04616b22c91f029af329a"

    - name: ray_branch
      default: "releases/0.8.2"


environment:
  # dockerfile: The dockerfile to be built and ran the commands with.
  # dockerimage: The docker image to be used to run the project in, e.g. ubuntu:18.04.
  requirements: ray-project/requirements.txt

  shell: # Shell commands to be ran for environment setup.
    - echo "Setting up the environment"

commands:
  - name: check-load
    command: uptime
    help: "Check load of the workload."

  - name: check-gpu
    command: nvidia-smi
    help: "Check load of the gpu."

  - name: show-output
    command: tmux capture-pane -p
    help: "Show tail of the workoad output."

  - name: run-regression-tests
    command: |
      source activate tensorflow_p36 && pip install torch torchvision
      source activate tensorflow_p36 && rllib train -f compact-regression-test.yaml
    help: "Run rllib regression tests"

# Pathnames for files and directories that should be saved
# in a snapshot but that should not be synced with a# session. Pathnames can be relative to the project
# directory or absolute. Generally, this should be files
# that were created by an active session, such as
# application checkpoints and logs.
output_files: [
  # For example, uncomment this to save the logs from the
  # last ray job.
  # "/tmp/ray/session_latest",
]