depsets:
  ray_base_test_depset:
    requirements:
      - python/requirements.txt
      - python/requirements/cloud-requirements.txt
      - python/requirements/base-test-requirements.txt
    constraints:
      - python/test/requirements_compiled_ray_test_py311_cpu.txt
    output: python/test/requirements_compiled_ray_test_py311_cpu.txt
    operation: compile
    flags:
      - --strip-extras
      - --python-version=3.11
      - --no-strip-markers
      - --emit-index-url
      - --emit-find-links
      - --unsafe-package ray
      - --unsafe-package grpcio-tools
      - --unsafe-package setuptools
      - --index-url "https://pypi.org/simple"
      - --extra-index-url "https://download.pytorch.org/whl/cpu"
      - --index-strategy unsafe-best-match
  
  general_depset:
    operation: compile
    requirements:
      - python/requirements.txt
    output: python/test/requirements_compiled_general_py311_cpu.txt

  cloud_depset:
    operation: compile
    requirements:
      - python/requirements/cloud-requirements.txt
    output: python/test/requirements_compiled_cloud_req_py311_cpu.txt

  base_test_depset:
    operation: compile
    requirements:
      - python/requirements/base-test-requirements.txt
    output: python/test/requirements_compiled_base_test_py311_cpu.txt

  llm_depset:
    operation: compile
    requirements:
      - python/requirements/llm/llm-requirements.txt
    output: python/test/requirements_compiled_llm_py311_cpu.txt

  llm_test_depset:
    operation: compile
    requirements:
      - python/requirements/llm/llm-test-requirements.txt
    output: python/test/requirements_compiled_llm_test_py311_cpu.txt

  compiled_ray_llm_test_depset:
    operation: expand
    depsets: 
      - general_depset
      - cloud_depset
      - base_test_depset
      - llm_depset
      - llm_test_depset
    constraints:
      - python/test/requirements_compiled_llm_test_py311_cpu.txt
    output: python/test/requirements_compiled_rayllm_test_py311_cpu.txt
    flags:
      - --strip-extras
      - --no-header
      - --no-cache
      - --python-version=3.11
      - --no-strip-markers
      - --emit-index-url
      - --emit-find-links
      - --unsafe-package ray
      - --unsafe-package grpcio-tools
      - --unsafe-package setuptools
      - --index-url "https://pypi.org/simple"
      - --extra-index-url "https://download.pytorch.org/whl/cpu"
      - --index-strategy unsafe-best-match

  compiled_ray_depset:
    operation: subset
    depsets: 
      - ray_base_test_depset
    requirements:
      - python/requirements.txt
    output: python/test/requirements_compiled_ray_py311_cpu.txt
    flags:
      - --strip-extras
      - --no-header
      - --no-cache
      - --python-version=3.11
      - --no-strip-markers
      - --emit-index-url
      - --emit-find-links
      - --unsafe-package ray
      - --unsafe-package grpcio-tools
      - --unsafe-package setuptools
      - --index-url "https://pypi.org/simple"
      - --extra-index-url "https://download.pytorch.org/whl/cpu"
      - --index-strategy unsafe-best-match