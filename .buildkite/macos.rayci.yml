group: macos tests
sort_key: "~macos"
steps:
  # block on premerge
  - block: "run macos tests"
    if: build.env("BUILDKITE_PIPELINE_ID") == "0189942e-0876-4b8f-80a4-617f988ec59b"

  - label: ":ray: core: :mac: small & large flaky tests"
    tags: 
      - core_cpp
      - python
      - macos_wheels
      - oss
    job_env: MACOS
    instance_type: macos
    soft_fail: true
    parallelism: 3
    commands:
      - ./ci/ray_ci/macos/macos_ci.sh run_small_and_large_flaky_tests
