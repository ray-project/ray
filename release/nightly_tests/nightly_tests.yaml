# Test basic single node 10GB shuffle.
- name: shuffle_10gb
  owner:
    mail: "ekl@anyscale.com"
    slack: "@proj-data-processing"

  cluster:
    app_config: shuffle/shuffle_app_config.yaml
    compute_template: shuffle/shuffle_compute_single.yaml

  run:
    timeout: 3000
    script: python shuffle/shuffle_test.py --num-partitions=50 --partition-size=200e6

  smoke_test:
    cluster:
      compute_template: shuffle/shuffle_compute_smoke.yaml  # Does not exist yet

# Test single node 10GB shuffle with large partitions.
- name: shuffle_10gb_large_partition
  owner:
    mail: "sangcho@anyscale.com"
    slack: "@proj-data-processing"

  cluster:
    app_config: shuffle/shuffle_app_config.yaml
    compute_template: shuffle/shuffle_compute_single.yaml

  run:
    timeout: 3000
    script: python shuffle/shuffle_test.py --num-partitions=500 --partition-size=50e6

  smoke_test:
    cluster:
      compute_template: shuffle/shuffle_compute_smoke.yaml  # Does not exist yet

# Test multi nodes 100GB shuffle with small partitions
- name: shuffle_100gb
  owner:
    mail: "sangcho@anyscale.com"
    slack: "@proj-data-processing"

  cluster:
    app_config: shuffle/shuffle_app_config.yaml
    compute_template: shuffle/shuffle_compute_multi.yaml

  run:
    timeout: 3000
    prepare: python wait_cluster.py 4 600
    script: python shuffle/shuffle_test.py --num-partitions=200 --partition-size=500e6

  smoke_test:
    cluster:
      compute_template: shuffle/shuffle_compute_smoke.yaml  # Does not exist yet

# Test multi nodes 100GB shuffle with large partitions
- name: shuffle_100gb_large_partition
  owner:
    mail: "sangcho@anyscale.com"
    slack: "@proj-data-processing"

  cluster:
    app_config: shuffle/shuffle_app_config.yaml
    compute_template: shuffle/shuffle_compute_multi.yaml

  run:
    timeout: 3000
    prepare: python wait_cluster.py 4 600
    script: python shuffle/shuffle_test.py --num-partitions=1000 --partition-size=100e6

  smoke_test:
    cluster:
      compute_template: shuffle/shuffle_compute_smoke.yaml  # Does not exist yet
