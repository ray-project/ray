base_image: {{ env["RAY_IMAGE_NIGHTLY_CPU"] }}
debian_packages: []

# We use retriable_lifo as the workload can crash due to multiple tasks from different
# callers running on the same node, we also observed raylet memory leak that would
# trigger the group-by-policy to fail the workload.
# https://github.com/ray-project/ray/issues/32195
env_vars: {"RAY_worker_killing_policy": "retriable_lifo"}

python:
  pip_packages: []
  conda_packages: []

post_build_cmds:
  - pip3 uninstall -y ray && pip3 install -U {{ env["RAY_WHEELS"] | default("ray") }}
  - pip3 install -U ray[default]
  - {{ env["RAY_WHEELS_SANITY_CHECK"] | default("echo No Ray wheels sanity check") }}
